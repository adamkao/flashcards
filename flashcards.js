var flashcards = [
[ "acertar", "to be on target, guess right", 0, 0 ],
[ "apretar", "to squeeze, be tight; to grip", 0, 0 ],
[ "ascender", "to go up, promote", 0, 0 ],
[ "atravesar", "to cross", 0, 0 ],
[ "cerrar", "to close", 0, 0 ],
[ "comenzar", "to begin", 0, 0 ],
[ "confesar", "to confess", 0, 0 ],
[ "defender", "to defend", 0, 0 ],
[ "descender", "to go down", 0, 0 ],
[ "despertar(se)", "to wake up", 0, 0 ],
[ "empezar", "to begin", 0, 0 ],
[ "encender", "to light, to turn on", 0, 0 ],
[ "encerrar", "to lock in, contain", 0, 0 ],
[ "entender", "to understand", 0, 0 ],
[ "gobernar", "to govern, manage, direct", 0, 0 ],
[ "helar", "to freeze", 0, 0 ],
[ "merender", "to have an afternoon snack, have a picnic", 0, 0 ],
[ "nevar", "to snow", 0, 0 ],
[ "perder", "to lose; to miss", 0, 0 ],
[ "quebrar", "to break", 0, 0 ],
[ "recomendar", "to recommend", 0, 0 ],
[ "sentar(se)", "to seat, sit down", 0, 0 ],
[ "acordarse", "to remember", 0, 0 ],
[ "acostar(se)", "to put to bed, go to bed", 0, 0 ],
[ "almorzar", "to have lunch", 0, 0 ],
[ "colgar", "to hang", 0, 0 ],
[ "conmover", "to move (emotionally)", 0, 0 ],
[ "contar", "to count, tell", 0, 0 ],
[ "costar", "to cost", 0, 0 ],
[ "demostrar", "to show", 0, 0 ],
[ "devolver", "to return, give back", 0, 0 ],
[ "doler", "to hurt, ache", 0, 0 ],
[ "encontrar", "to find", 0, 0 ],
[ "envolver", "to wrap up", 0, 0 ],
[ "jugar", "to play", 0, 0 ],
[ "llover", "to rain", 0, 0 ],
[ "mostrar", "to show", 0, 0 ],
[ "oler", "to smell", 0, 0 ],
[ "probar(se)", "to try, taste, try on", 0, 0 ],
[ "recordar", "to remember; to remind", 0, 0 ],
[ "resolver", "to solve, resolve, decide", 0, 0 ],
[ "rodar", "to roll; to film", 0, 0 ],
[ "soler", "to be accustomed to doing, to usually do something", 0, 0 ],
[ "tronar", "to thunder", 0, 0 ],
[ "volar", "to fly", 0, 0 ],
[ "advertir", "to notify, warn, point out", 0, 0 ],
[ "convertir", "to convert", 0, 0 ],
[ "convertirse en", "to become", 0, 0 ],
[ "divertirse", "to have a good time", 0, 0 ],
[ "hervir", "to boil", 0, 0 ],
[ "mentir", "to lie", 0, 0 ],
[ "preferir", "to prefer", 0, 0 ],
[ "referirse (a)", "to refer (to)", 0, 0 ],
[ "sentirse", "to feel", 0, 0 ],
[ "conseguir", "to get, obtain; to manage to", 0, 0 ],
[ "despedir", "to fire", 0, 0 ],
[ "despedirse (de)", "to say good-bye", 0, 0 ],
[ "gemir", "to groan, moan", 0, 0 ],
[ "impedir", "to prevent", 0, 0 ],
[ "medir", "to measure", 0, 0 ],
[ "perseguir", "to pursue, aim for", 0, 0 ],
[ "proseguir", "to pursue, proceed", 0, 0 ],
[ "reír(se)", "to laugh", 0, 0 ],
[ "reñir", "to quarrel, scold", 0, 0 ],
[ "repetir", "to repeat; to have a second helping", 0, 0 ],
[ "seguir", "to follow, continue", 0, 0 ],
[ "servir", "to serve", 0, 0 ],
[ "sonreír(se)", "to smile", 0, 0 ],
[ "vestir(se)", "to dress", 0, 0 ],
[ "atribuir", "to attribute", 0, 0 ],
[ "concluir", "to conclude", 0, 0 ],
[ "contribuir", "to contribute", 0, 0 ],
[ "destruir", "to destroy", 0, 0 ],
[ "distribuir", "to distribute", 0, 0 ],
[ "huir", "to flee", 0, 0 ],
[ "incluir", "to include", 0, 0 ],
[ "influir", "to influence", 0, 0 ],
[ "sustituir", "to substitute", 0, 0 ],
[ "confiar (en)", "to trust, rely (on), confide (in)", 0, 0 ],
[ "criar", "to raise, bring up", 0, 0 ],
[ "desafiar", "to challenge, defy", 0, 0 ],
[ "enviar", "to send", 0, 0 ],
[ "espiar", "to spy", 0, 0 ],
[ "esquiar", "to ski", 0, 0 ],
[ "fiarse (de)", "to trust", 0, 0 ],
[ "resfriarse", "to catch cold", 0, 0 ],
[ "vaciar", "to empty", 0, 0 ],
[ "variar", "to vary", 0, 0 ],
[ "acentuar", "to accentuate", 0, 0 ],
[ "actuar", "to act, perform, behave", 0, 0 ],
[ "efectuar", "to effect, carry out, execute", 0, 0 ],
[ "evaluar", "to evaluate, assess", 0, 0 ],
[ "graduarse", "to graduate", 0, 0 ],
[ "insinuar", "to hint", 0, 0 ],
[ "acoger", "to welcome, receive", 0, 0 ],
[ "afligir", "to afflict", 0, 0 ],
[ "coger", "to take, grasp, catch", 0, 0 ],
[ "corregir", "to correct", 0, 0 ],
[ "dirigir", "to direct; to lead, conduct", 0, 0 ],
[ "elegir", "to choose, elect", 0, 0 ],
[ "encoger", "to shring", 0, 0 ],
[ "exigir", "to demand", 0, 0 ],
[ "fingir", "to pretend", 0, 0 ],
[ "proteger", "to protect", 0, 0 ],
[ "recoger", "to collect; to gather; to pick up", 0, 0 ],
[ "surgir", "to arise", 0, 0 ],
[ "escoger", "to choose", 0, 0 ],
[ "cocer", "to cook", 0, 0 ],
[ "torcer", "to twist", 0, 0 ],
//[ "", "", 0, 0 ],
];

function shuffle( array ) {
	var currentIndex = array.length, temporaryValue, randomIndex;
	while (0 !== currentIndex) {
		randomIndex = Math.floor( Math.random() * currentIndex );
		currentIndex -= 1;
		temporaryValue = array[currentIndex];
		array[currentIndex] = array[randomIndex];
		array[randomIndex] = temporaryValue;
	}
	return array;
}

var answer = "", correct = "", last = 0, attempts = 0, success = 0, pass = 1, rand = 0, prob = 0;

function done( e ) {
	attempts++;
	answer = $( "#answer" ).val();
	if (flashcards[last][0] == answer) {
		correct = "Right!";
		success++;
	} else {
		correct = "Wrong!";
	}
	correct += " " + success + "/" + attempts;
	$( "#response" ).html( correct + " " + flashcards[last][1] + '<br>' + flashcards[last][0] + '<br>' + prob );

	flashcards[last][3] = attempts;
	flashcards[last][2] = success;

	$( "#answer" ).val( '' );
	$( "#answer" ).focus();

	do {
		last++;
		if (last >= flashcards.length) {
			shuffle( flashcards );
			pass++;
			last = 0;
		}
		attempts = flashcards[last][3];
		success = flashcards[last][2];
		prob = (success*success)/((attempts*attempts) + 1);
		rand = Math.random();
	} while (rand < prob);
	$( "#question" ).html( pass + ":  " + flashcards[last][1] );	
}

$( document ).ready( function() {
	
	shuffle( flashcards );
	$( "#question" ).html( pass + ":  " + flashcards[last][1] );	
	attempts = flashcards[last][3];
	success = flashcards[last][2];

	$( '#answer' ).on( 'keydown', function( event ) {
		if ((event.which == 10) || (event.which == 13)) {
			done( event );
		}
	} );
	$( "#done" ).click( function( e ) { done } );
} );
